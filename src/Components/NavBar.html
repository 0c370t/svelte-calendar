<div class="title">
  <div class="heading-section">
    <div class="control" 
      class:enabled="canDecrementMonth"
      on:click="fire('incrementMonth', -1)">
      <i class="arrow left"></i>
    </div>
    <div class="label" on:click="toggleMonthSelectorOpen()">
      {monthDict[month].name} {year}
    </div> 
    <div class="control"
      class:enabled="canIncrementMonth"
      on:click="fire('incrementMonth', 1)">
      <i class="arrow right"></i>
    </div>
  </div>
  <div class="month-selector" class:open="monthSelectorOpen">
    {#each monthDict as monthDefinition, index}
      <div 
        class="month-selector--month" 
        class:selected="index==month"
        on:click="monthSelected(event,index)"
      >
        <span>{monthDefinition.abbrev}</span>
      </div>
    {/each}
  </div>
</div>

<style>
  .heading-section { 
    font-size: 20px;;
    padding: 24px 15px;
    display: flex;
    justify-content: space-between;
    color: #3d4548;
    font-weight: bold;
  }
  .label { 
    cursor: pointer;
  }
  .month-selector { 
    position: absolute;
    top: 75px; 
    left: 0; 
    right: 0; 
    bottom: 0; 
    background-color: #fff;
    transition: all 300ms; 
    transform: scale(1.2); 
    opacity: 0; 
    visibility: hidden;
    z-index: 1;
    text-align: center;
  }
  .month-selector.open { 
    transform: scale(1); 
    visibility: visible;
    opacity: 1;
  }
  .month-selector--month { 
    width: 31.333%; 
    margin: 1%; 
    height: 23%;
    display: inline-block;
    border: 2px solid #eee;
    color: #4a4a4a;
  }
  .month-selector--month:hover { 
    border-color: #f7901e;
    cursor: pointer;
  }
  .month-selector--month.selected { 
    background: #f7901e;
    color: #fff;
  }
  .month-selector--month:before { 
    content: ' ';
    display: inline-block;
    height: 100%;
    vertical-align: middle;
  }
  .month-selector--month span { 
    vertical-align: middle; 
    display: inline-block;
  }

  .control { 
    padding: 0 8px;
    opacity: 0.2;
  }

  .control.enabled { 
    opacity: 1; 
    cursor: pointer;
  }

  .arrow {
    display: inline-block;
    width: 18px;
    height: 18px;
    border-style: solid;
    border-color: #a9a9a9;
    border-width: 0;
    border-bottom-width: 2px;
    border-right-width: 2px;
  }

  .arrow.right {
    transform: rotate(-45deg);
    -webkit-transform: rotate(-45deg);
  }

  .arrow.left {
    transform: rotate(135deg);
    -webkit-transform: rotate(135deg);
  }

</style>

<script>
  import {monthDict} from './lib/dictionaries';
  export default { 
    data() { 
      return { 
        monthDict, 
        monthSelectorOpen: false
      }
    }, 
    methods: { 
      toggleMonthSelectorOpen() { 
        let {monthSelectorOpen} = this.get(); 
        monthSelectorOpen = !monthSelectorOpen;
        this.set({monthSelectorOpen});
      }, 
      monthSelected(event,month) { 
        event.stopPropagation(); 
        this.fire('monthSelected', month);
        this.toggleMonthSelectorOpen();
      }
    }
  }
</script>